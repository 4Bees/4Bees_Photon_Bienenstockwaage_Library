#include "HX711.h"
#include "cloud4bees.h"

Cloud4BeesLibrary::Cloud4Bees cloud4bees ("EF836YPX6SBK0ZZL");

// HX711.DOUT	- pin #D1
// HX711.PD_SCK	- pin #D0

// HX711 scale(D1, D0);		// parameter "gain" is ommited; the default value 128 is used by the library

#define DOUT  D0
#define CLK  D1

HX711 scale(DOUT, CLK);


//float offset = 0;
//float scalefactor = 1;

float offset = 276.9;
float scalefactor = 31679.0;

float floatGewicht = 0;
float floatTemperatur = 0;


void setup()
{
 
    
  Serial.begin(9600);
  scale.set_scale(scalefactor);                      //this value is obtained by calibrating the scale with known weights; 
                                                 /*   How to Calibrate Your Scale
                                                      1.Call set_scale() with no parameter.
                                                      2.Call set_tare() with no parameter.
                                                      3.Place a known weight on the scale and call get_units(10).
                                                      4.Divide the result in step 3 to your known weight. You should get about the parameter you need to pass to set_scale.
                                                      5.Adjust the parameter in step 4 until you get an accurate reading. 
                                                  */
   
}

void loop()
{ 
  Serial.print("Average weight from 10 messures:\t");
  float floatGewicht = (scale.get_units(10) - offset);
  Serial.println(floatGewicht);
  floatTemperatur = 10;
  
 
    //Send Value to cloud4Bees
    
    bool valSet = cloud4bees.recordValue(1, String(floatGewicht));
    if(valSet) {
        Serial.println("Value set to field 1 : " + String(floatGewicht));
    } else {
        Serial.println("Value not set successfully");
    }
    
    bool valsSent = cloud4bees.sendValues();
    if(valsSent) {
        Serial.println("Value successfully sent to Cloud4Bees");
    } else { 
        Serial.println("Sending to Cloud4Bees failed");
    }
   
    delay(60000);
 
}


